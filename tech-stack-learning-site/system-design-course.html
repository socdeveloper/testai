<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>System Design Course - TechStack Mastery</title>
    <link rel="stylesheet" href="styles.css">
    <style>
        .lesson-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .lesson-header {
            text-align: center;
            margin-bottom: 30px;
        }
        
        .lesson-content {
            background: white;
            border-radius: 10px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.05);
        }
        
        .diagram {
            background: #f8fafc;
            border: 1px solid #cbd5e0;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
            text-align: center;
        }
        
        .code-block {
            background: #2d3748;
            color: #e2e8f0;
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
            overflow-x: auto;
            font-family: 'Courier New', monospace;
        }
        
        .exercise {
            background: #fffbeb;
            border-left: 4px solid #f59e0b;
            padding: 20px;
            margin: 20px 0;
            border-radius: 0 8px 8px 0;
        }
        
        .exercise h3 {
            color: #92400e;
            margin-top: 0;
        }
        
        .navigation {
            display: flex;
            justify-content: space-between;
            margin-top: 30px;
        }
        
        .nav-btn {
            background-color: #2563eb;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 1rem;
            text-decoration: none;
            display: inline-block;
        }
        
        .nav-btn:hover {
            background-color: #1d4ed8;
        }
        
        .nav-btn.prev {
            background-color: #64748b;
        }
        
        .nav-btn.prev:hover {
            background-color: #475569;
        }
        
        .lesson-progress {
            background: #e2e8f0;
            height: 10px;
            border-radius: 5px;
            margin: 20px 0;
            overflow: hidden;
        }
        
        .progress-bar {
            height: 100%;
            background: #2563eb;
            width: 60%; /* This would be dynamic in a real app */
        }
        
        .design-element {
            display: inline-block;
            background: #e2e8f0;
            padding: 10px 15px;
            margin: 5px;
            border-radius: 5px;
            border: 1px solid #cbd5e0;
        }
        
        .tech-highlight {
            background: #dbeafe;
            padding: 2px 6px;
            border-radius: 4px;
            font-weight: bold;
        }
        
        .system-requirements {
            background: #f0fdf4;
            border-left: 4px solid #10b981;
            padding: 20px;
            margin: 20px 0;
        }
        
        .requirement-list {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        
        .requirement-card {
            background: white;
            padding: 15px;
            border-radius: 8px;
            border: 1px solid #cbd5e0;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
        }
    </style>
</head>
<body>
    <header>
        <nav>
            <div class="logo">TechStack Mastery</div>
            <ul class="nav-links">
                <li><a href="index.html">Home</a></li>
                <li><a href="#technologies">Technologies</a></li>
                <li><a href="#courses">Courses</a></li>
                <li><a href="#practice">Practice</a></li>
                <li><a href="#career">Career Prep</a></li>
            </ul>
        </nav>
    </header>

    <main>
        <div class="lesson-container">
            <div class="lesson-header">
                <h1>System Design - Lesson 1: High-Performance Event-Driven Architecture</h1>
                <div class="lesson-progress">
                    <div class="progress-bar"></div>
                </div>
                <p>Design scalable systems using Go, Redpanda, PostgreSQL, MongoDB, and Reindexer</p>
            </div>
            
            <div class="lesson-content">
                <h2>Building High-Performance, Scalable Systems</h2>
                <p>Modern backend systems require careful architecture to handle high loads while maintaining reliability and performance. This lesson covers how to leverage the complete tech stack for optimal results.</p>
                
                <div class="system-requirements">
                    <h3>System Requirements</h3>
                    <p>Design a system that can handle:</p>
                    <div class="requirement-list">
                        <div class="requirement-card">
                            <strong>10,000+ requests/second</strong>
                            <p>High throughput API layer using Go microservices</p>
                        </div>
                        <div class="requirement-card">
                            <strong>Real-time processing</strong>
                            <p>Event streaming with Redpanda for microsecond latency</p>
                        </div>
                        <div class="requirement-card">
                            <strong>Consistent data storage</strong>
                            <p>PostgreSQL for transactional data with ACID compliance</p>
                        </div>
                        <div class="requirement-card">
                            <strong>Flexible analytics</strong>
                            <p>MongoDB for complex aggregation queries</p>
                        </div>
                        <div class="requirement-card">
                            <strong>Fast queries</strong>
                            <p>Reindexer for sub-millisecond response times</p>
                        </div>
                        <div class="requirement-card">
                            <strong>High availability</strong>
                            <p>Replication and failover across multiple zones</p>
                        </div>
                    </div>
                </div>
                
                <h2>Architecture Overview</h2>
                <div class="diagram">
                    <p><strong>High-Level Architecture</strong></p>
                    <div>
                        <div class="design-element">Load Balancer</div>
                        <div style="margin: 10px 0;">↓</div>
                        <div class="design-element"><span class="tech-highlight">Go API Gateway</span></div>
                        <div style="margin: 10px 0;">↓</div>
                        <div class="design-element">Service Discovery</div>
                        <div style="margin: 10px 0;">↓</div>
                        <div style="display: flex; justify-content: space-around;">
                            <div class="design-element"><span class="tech-highlight">Go Microservices</span></div>
                            <div class="design-element"><span class="tech-highlight">Go Microservices</span></div>
                            <div class="design-element"><span class="tech-highlight">Go Microservices</span></div>
                        </div>
                        <div style="margin: 10px 0;">↓</div>
                        <div class="design-element"><span class="tech-highlight">Redpanda</span> (Event Streaming)</div>
                        <div style="margin: 10px 0;">↓</div>
                        <div style="display: flex; justify-content: space-around;">
                            <div class="design-element"><span class="tech-highlight">PostgreSQL</span> (OLTP)</div>
                            <div class="design-element"><span class="tech-highlight">MongoDB</span> (Analytics)</div>
                            <div class="design-element"><span class="tech-highlight">Reindexer</span> (Fast Queries)</div>
                        </div>
                    </div>
                </div>
                
                <h2>Technology Integration</h2>
                <p>Each technology in our stack serves a specific purpose in the system:</p>
                
                <h3>Go Microservices</h3>
                <p>Go is chosen for its performance, concurrency model, and efficient memory management. Each microservice is responsible for a specific domain.</p>
                
                <div class="code-block">
                    // Example Go service with HTTP handlers
                    package main
                    
                    import (
                        "context"
                        "encoding/json"
                        "log"
                        "net/http"
                        "time"
                        
                        "github.com/gin-gonic/gin"
                    )
                    
                    type UserService struct {
                        db *Database
                        producer EventProducer
                    }
                    
                    func (s *UserService) GetUser(c *gin.Context) {
                        userID := c.Param("id")
                        
                        user, err := s.db.GetUser(userID)
                        if err != nil {
                            c.JSON(http.StatusNotFound, gin.H{"error": "User not found"})
                            return
                        }
                        
                        c.JSON(http.StatusOK, user)
                    }
                    
                    func (s *UserService) CreateUser(c *gin.Context) {
                        var user User
                        if err := c.ShouldBindJSON(&user); err != nil {
                            c.JSON(http.StatusBadRequest, gin.H{"error": err.Error()})
                            return
                        }
                        
                        // Publish event to Redpanda
                        event := UserCreatedEvent{
                            UserID: user.ID,
                            Timestamp: time.Now(),
                        }
                        s.producer.Publish("user.created", event)
                        
                        c.JSON(http.StatusCreated, user)
                    }
                </div>
                
                <h3>Redpanda for Event Streaming</h3>
                <p>Redpanda handles real-time data streaming between services, ensuring decoupling and scalability.</p>
                
                <div class="code-block">
                    // Example Go consumer
                    package main
                    
                    import (
                        "context"
                        "log"
                        
                        "github.com/twmb/franz-go/pkg/kgo"
                    )
                    
                    func startConsumer() {
                        client, err := kgo.NewClient(
                            kgo.SeedBrokers("redpanda:9092"),
                            kgo.ConsumerGroup("user-service-group"),
                            kgo.ConsumeTopics("user.created"),
                        )
                        if err != nil {
                            log.Fatal(err)
                        }
                        defer client.Close()
                        
                        for {
                            fetches := client.PollFetches(context.Background())
                            if errs := fetches.Errors(); len(errs) > 0 {
                                log.Printf("Error fetching: %v", errs)
                                continue
                            }
                            
                            fetches.EachRecord(func(r *kgo.Record) {
                                log.Printf("Processing event: %s", string(r.Value))
                                // Process the event
                            })
                        }
                    }
                </div>
                
                <h3>Database Strategy</h3>
                <p>Each database serves a specific purpose:</p>
                <ul>
                    <li><span class="tech-highlight">PostgreSQL</span>: For transactional data requiring ACID compliance</li>
                    <li><span class="tech-highlight">MongoDB</span>: For complex analytics and aggregation queries</li>
                    <li><span class="tech-highlight">Reindexer</span>: For ultra-fast queries and caching</li>
                </ul>
                
                <div class="exercise">
                    <h3>Design Challenge</h3>
                    <p>Design a real-time notification system that can handle 1 million concurrent users. Consider:</p>
                    <ul>
                        <li>How would you architect the Go microservices?</li>
                        <li>What Redpanda topics would you create?</li>
                        <li>How would you store user preferences?</li>
                        <li>How would you handle delivery guarantees?</li>
                        <li>How would you ensure sub-millisecond query performance?</li>
                    </ul>
                    
                    <textarea class="query-editor" style="width: 100%; height: 200px; margin-top: 15px;" placeholder="Describe your system design here..."></textarea>
                    <button class="practice-btn" style="margin-top: 10px;">Submit Design</button>
                </div>
                
                <h2>Performance Optimization</h2>
                <p>Key optimization strategies for the stack:</p>
                
                <h3>Go Optimizations</h3>
                <ul>
                    <li>Use sync.Pool for object reuse</li>
                    <li>Profile with pprof and optimize bottlenecks</li>
                    <li>Implement proper error handling and logging</li>
                    <li>Use context for request cancellation and timeouts</li>
                </ul>
                
                <h3>Database Optimizations</h3>
                <ul>
                    <li>Proper indexing strategies for PostgreSQL</li>
                    <li>Sharding strategy for MongoDB</li>
                    <li>Cache frequently accessed data in Reindexer</li>
                    <li>Connection pooling for all databases</li>
                </ul>
                
                <h3>Monitoring and Observability</h3>
                <p>Implement comprehensive monitoring using Prometheus and Grafana:</p>
                
                <div class="code-block">
                    // Example Go metrics
                    package main
                    
                    import (
                        "github.com/prometheus/client_golang/prometheus"
                        "github.com/prometheus/client_golang/prometheus/promauto"
                        "github.com/prometheus/client_golang/prometheus/promhttp"
                    )
                    
                    var (
                        requestCount = promauto.NewCounterVec(
                            prometheus.CounterOpts{
                                Name: "http_requests_total",
                                Help: "Total number of HTTP requests",
                            },
                            []string{"method", "endpoint"},
                        )
                        
                        requestDuration = promauto.NewHistogramVec(
                            prometheus.HistogramOpts{
                                Name: "http_request_duration_seconds",
                                Help: "Duration of HTTP requests",
                            },
                            []string{"method", "endpoint"},
                        )
                    )
                </div>
            </div>
            
            <div class="navigation">
                <a href="#" class="nav-btn prev">Previous Lesson</a>
                <a href="#" class="nav-btn">Next Lesson</a>
            </div>
        </div>
    </main>

    <script>
        // Initialize the page
        document.addEventListener('DOMContentLoaded', function() {
            console.log('System Design Course Lesson loaded!');
        });
    </script>
</body>
</html>